<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>KI-Assistent - PlanPal KI</title>
<link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700&display=swap" rel="stylesheet">
<style>
:root {
  --primary: #2563eb;
  --secondary: #06b6d4;
  --accent: #f59e0b;
  --success: #10b981;
  --danger: #ef4444;
  --background: #f9fafb;
  --surface: #ffffff;
  --text-dark: #111827;
  --text-light: #6b7280;
  --radius: 1.5rem;
  --shadow: 0 8px 24px rgba(0,0,0,0.08);
  --border: #e5e7eb;
  --ai-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
}

* {margin:0; padding:0; box-sizing:border-box;}
body {
  font-family:'Nunito', sans-serif;
  background: var(--background);
  color:var(--text-dark);
  min-height: 100vh;
}

/* HEADER */
header {
  background: var(--ai-gradient);
  color: white;
  box-shadow: var(--shadow);
  padding: 1rem 2rem;
  display: flex;
  justify-content: space-between;
  align-items: center;
  position: sticky;
  top: 0;
  z-index: 50;
}

.logo-container {
  display: flex;
  align-items: center;
}

.logo-container img {
  height: 45px;
  margin-right: 12px;
  filter: brightness(0) invert(1);
}

.logo-container h1 {
  font-size: 1.8rem;
  font-weight: 800;
}

.header-nav {
  display: flex;
  align-items: center;
  gap: 1.5rem;
}

.back-btn {
  background: rgba(255,255,255,0.2);
  color: white;
  border: 1px solid rgba(255,255,255,0.3);
  padding: 0.6rem 1.2rem;
  border-radius: 0.8rem;
  font-weight: 600;
  cursor: pointer;
  text-decoration: none;
  display: flex;
  align-items: center;
  gap: 0.5rem;
  transition: all 0.3s;
  backdrop-filter: blur(10px);
}

.back-btn:hover {
  background: rgba(255,255,255,0.3);
  transform: translateY(-2px);
}

/* MAIN CONTAINER */
.main-container {
  max-width: 1200px;
  margin: 2rem auto;
  padding: 0 2rem;
  display: grid;
  grid-template-columns: 1fr 350px;
  gap: 2rem;
  min-height: calc(100vh - 120px);
}

/* CHAT MAIN */
.chat-main {
  background: var(--surface);
  border-radius: var(--radius);
  box-shadow: var(--shadow);
  height: calc(100vh - 200px);
  display: flex;
  flex-direction: column;
  overflow: hidden;
}

.chat-header {
  background: var(--ai-gradient);
  color: white;
  padding: 1.5rem 2rem;
  display: flex;
  align-items: center;
  gap: 1rem;
}

.ai-avatar {
  width: 50px;
  height: 50px;
  background: rgba(255,255,255,0.2);
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 1.5rem;
}

.ai-info h3 {
  font-size: 1.3rem;
  margin-bottom: 0.3rem;
}

.ai-info p {
  opacity: 0.9;
  font-size: 0.9rem;
}

.ai-status {
  margin-left: auto;
  display: flex;
  align-items: center;
  gap: 0.5rem;
  font-size: 0.9rem;
}

.status-dot {
  width: 8px;
  height: 8px;
  background: #10b981;
  border-radius: 50%;
  animation: pulse 2s infinite;
}

@keyframes pulse {
  0% { opacity: 1; }
  50% { opacity: 0.5; }
  100% { opacity: 1; }
}

/* CHAT MESSAGES */
.chat-messages {
  flex: 1;
  padding: 1.5rem;
  overflow-y: auto;
  background: linear-gradient(180deg, #fafbff 0%, #f8fafc 100%);
}

.message {
  margin-bottom: 1.5rem;
  display: flex;
  gap: 1rem;
}

.message.user {
  flex-direction: row-reverse;
}

.message-avatar {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 1.2rem;
  flex-shrink: 0;
}

.message.ai .message-avatar {
  background: var(--ai-gradient);
  color: white;
}

.message.user .message-avatar {
  background: var(--primary);
  color: white;
}

.message-content {
  background: white;
  padding: 1rem 1.5rem;
  border-radius: 1.5rem;
  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
  max-width: 70%;
  position: relative;
}

.message.ai .message-content {
  background: linear-gradient(135deg, #f8faff 0%, #f1f5ff 100%);
  border: 1px solid #e0e7ff;
}

.message.user .message-content {
  background: var(--primary);
  color: white;
}

.message-time {
  font-size: 0.75rem;
  opacity: 0.7;
  margin-top: 0.5rem;
}

.typing-indicator {
  display: none;
  align-items: center;
  gap: 0.5rem;
  font-style: italic;
  color: var(--text-light);
}

.typing-dots {
  display: flex;
  gap: 0.2rem;
}

.typing-dot {
  width: 6px;
  height: 6px;
  background: var(--text-light);
  border-radius: 50%;
  animation: typing 1.4s infinite;
}

.typing-dot:nth-child(2) { animation-delay: 0.2s; }
.typing-dot:nth-child(3) { animation-delay: 0.4s; }

@keyframes typing {
  0%, 60% { opacity: 0.3; }
  30% { opacity: 1; }
}

/* CHAT INPUT */
.chat-input-container {
  padding: 1.5rem;
  background: white;
  border-top: 1px solid var(--border);
}

.chat-input-wrapper {
  display: flex;
  gap: 1rem;
  align-items: end;
}

.chat-input {
  flex: 1;
  min-height: 50px;
  max-height: 120px;
  padding: 1rem;
  border: 2px solid var(--border);
  border-radius: 1.5rem;
  font-family: 'Nunito', sans-serif;
  resize: none;
  transition: all 0.3s;
  font-size: 1rem;
  line-height: 1.4;
}

.chat-input:focus {
  outline: none;
  border-color: var(--primary);
  box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
}

.send-btn {
  background: var(--ai-gradient);
  color: white;
  border: none;
  width: 50px;
  height: 50px;
  border-radius: 50%;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 1.2rem;
  transition: all 0.3s;
  flex-shrink: 0;
}

.send-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 12px rgba(102, 126, 234, 0.3);
}

.send-btn:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

/* SIDEBAR */
.ai-sidebar {
  display: flex;
  flex-direction: column;
  gap: 1.5rem;
  height: fit-content;
  position: sticky;
  top: 100px;
}

.sidebar-section {
  background: var(--surface);
  border-radius: var(--radius);
  padding: 1.5rem;
  box-shadow: var(--shadow);
}

.sidebar-section h4 {
  color: var(--primary);
  margin-bottom: 1rem;
  font-weight: 700;
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

/* QUICK SUGGESTIONS */
.suggestions-grid {
  display: grid;
  gap: 0.8rem;
}

.suggestion-btn {
  background: linear-gradient(135deg, #f0f4ff 0%, #e0e7ff 100%);
  border: 1px solid #c7d2fe;
  color: var(--primary);
  padding: 1rem;
  border-radius: 1rem;
  cursor: pointer;
  text-align: left;
  font-weight: 600;
  transition: all 0.3s;
  font-size: 0.9rem;
}

.suggestion-btn:hover {
  background: linear-gradient(135deg, #e0e7ff 0%, #c7d2fe 100%);
  transform: translateY(-2px);
  box-shadow: 0 4px 8px rgba(0,0,0,0.1);
}

/* AI CAPABILITIES */
.capability-item {
  display: flex;
  align-items: center;
  gap: 0.8rem;
  padding: 0.8rem;
  background: var(--background);
  border-radius: 0.8rem;
  margin-bottom: 0.8rem;
  border-left: 3px solid var(--success);
}

.capability-icon {
  font-size: 1.2rem;
  opacity: 0.8;
}

.capability-text {
  font-size: 0.9rem;
  font-weight: 600;
}

/* CONTEXT DISPLAY */
.context-info {
  background: var(--background);
  padding: 1rem;
  border-radius: 1rem;
  font-size: 0.85rem;
  color: var(--text-light);
}

.context-item {
  display: flex;
  justify-content: space-between;
  margin-bottom: 0.5rem;
}

.context-item:last-child {
  margin-bottom: 0;
}

/* RESPONSIVE */
@media(max-width:1024px){
  .main-container {
    grid-template-columns: 1fr;
    gap: 2rem;
  }
  
  .ai-sidebar {
    position: static;
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 1.5rem;
  }
  
  .chat-main {
    height: 70vh;
  }
}

@media(max-width:768px){
  .main-container {
    padding: 0 1rem;
    margin: 1rem auto;
  }
  
  .chat-header {
    padding: 1rem;
    flex-direction: column;
    text-align: center;
    gap: 0.5rem;
  }
  
  .ai-status {
    margin-left: 0;
  }
  
  .message-content {
    max-width: 85%;
  }
  
  header {
    flex-direction: column;
    text-align: center;
    padding: 1rem;
  }
  
  .header-nav {
    margin-top: 1rem;
  }
  
  .logo-container h1 {
    font-size: 1.4rem;
  }
}
</style>
</head>
<body>

<header>
  <div class="logo-container">
    <img src="logo.png" alt="PlanPal Logo">
    <h1>ğŸ¤– PlanPal KI-Assistent</h1>
  </div>
  <div class="header-nav">
    <a href="schichtplaner.html" class="back-btn">ğŸ“… Schichtplaner</a>
    <a href="index.html" class="back-btn">â† Zur Hauptseite</a>
  </div>
</header>

<div class="main-container">
  <!-- Chat Hauptbereich -->
  <div class="chat-main">
    <div class="chat-header">
      <div class="ai-avatar">ğŸ¤–</div>
      <div class="ai-info">
        <h3>KI-Schichtplaner Assistent</h3>
        <p>Intelligente Planung fÃ¼r optimale ArbeitsablÃ¤ufe</p>
      </div>
      <div class="ai-status">
        <div class="status-dot"></div>
        <span>Online</span>
      </div>
    </div>
    
    <div class="chat-messages" id="chatMessages">
      <!-- Willkommensnachricht -->
      <div class="message ai">
        <div class="message-avatar">ğŸ¤–</div>
        <div class="message-content">
          <p>Hallo! Ich bin Ihr intelligenter Schichtplaner-Assistent. Ich kann Ihnen bei folgenden Aufgaben helfen:</p>
          <ul style="margin: 1rem 0; padding-left: 1.5rem;">
            <li>ğŸ“… Optimale SchichtplÃ¤ne erstellen</li>
            <li>âš–ï¸ Faire Arbeitszeiten-Verteilung</li>
            <li>ğŸ” Konflikte und Probleme erkennen</li>
            <li>ğŸ“Š Arbeitszeit-Analysen</li>
            <li>ğŸ’¡ VerbesserungsvorschlÃ¤ge</li>
          </ul>
          <p>Stellen Sie mir einfach Ihre Frage oder beschreiben Sie Ihr Planungs-Problem!</p>
          <div class="message-time">Gerade eben</div>
        </div>
      </div>
      
      <!-- Typing Indicator -->
      <div class="message ai typing-indicator" id="typingIndicator">
        <div class="message-avatar">ğŸ¤–</div>
        <div class="message-content">
          <div class="typing-indicator">
            KI denkt nach
            <div class="typing-dots">
              <div class="typing-dot"></div>
              <div class="typing-dot"></div>
              <div class="typing-dot"></div>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <div class="chat-input-container">
      <div class="chat-input-wrapper">
        <textarea 
          class="chat-input" 
          id="chatInput" 
          placeholder="Fragen Sie mich nach Schichtplanung, Optimierungen oder Problemen..."
          rows="1"
        ></textarea>
        <button class="send-btn" id="sendBtn" onclick="sendMessage()">
          â¤
        </button>
      </div>
    </div>
  </div>
  
  <!-- Sidebar -->
  <div class="ai-sidebar">
    
    <!-- Schnelle Fragen -->
    <div class="sidebar-section">
      <h4>ğŸ’¡ Schnelle Fragen</h4>
      <div class="suggestions-grid">
        <button class="suggestion-btn" onclick="askQuickQuestion('Wie erstelle ich einen fairen Schichtplan?')">
          Wie erstelle ich einen fairen Schichtplan?
        </button>
        <button class="suggestion-btn" onclick="askQuickQuestion('Optimiere meinen aktuellen Schichtplan')">
          Optimiere meinen aktuellen Schichtplan
        </button>
        <button class="suggestion-btn" onclick="askQuickQuestion('Wie vermeide ich Ãœberstunden?')">
          Wie vermeide ich Ãœberstunden?
        </button>
        <button class="suggestion-btn" onclick="askQuickQuestion('Urlaubsplanung berÃ¼cksichtigen')">
          Urlaubsplanung berÃ¼cksichtigen
        </button>
        <button class="suggestion-btn" onclick="askQuickQuestion('Mitarbeiter-PrÃ¤ferenzen einbauen')">
          Mitarbeiter-PrÃ¤ferenzen einbauen
        </button>
        <button class="suggestion-btn" onclick="askQuickQuestion('Nachtschichten fair verteilen')">
          Nachtschichten fair verteilen
        </button>
      </div>
    </div>
    
    <!-- KI FÃ¤higkeiten -->
    <div class="sidebar-section">
      <h4>ğŸ§  KI-FÃ¤higkeiten</h4>
      <div class="capability-item">
        <div class="capability-icon">ğŸ“ˆ</div>
        <div class="capability-text">Mustererkennung in Arbeitszeiten</div>
      </div>
      <div class="capability-item">
        <div class="capability-icon">âš–ï¸</div>
        <div class="capability-text">Automatische Fairness-Analyse</div>
      </div>
      <div class="capability-item">
        <div class="capability-icon">ğŸ”®</div>
        <div class="capability-text">Predictive Scheduling</div>
      </div>
      <div class="capability-item">
        <div class="capability-icon">ğŸ› ï¸</div>
        <div class="capability-text">KonfliktlÃ¶sung</div>
      </div>
      <div class="capability-item">
        <div class="capability-icon">ğŸ“Š</div>
        <div class="capability-text">Echtzeit-Optimierung</div>
      </div>
    </div>
    
    <!-- Kontext -->
    <div class="sidebar-section">
      <h4>ğŸ“‹ Aktueller Kontext</h4>
      <div class="context-info" id="contextInfo">
        <div class="context-item">
          <span>Mitarbeiter:</span>
          <span>6 Personen</span>
        </div>
        <div class="context-item">
          <span>Teams:</span>
          <span>4 Teams (A-D)</span>
        </div>
        <div class="context-item">
          <span>Zeitraum:</span>
          <span>Aktueller Monat</span>
        </div>
        <div class="context-item">
          <span>Schichten:</span>
          <span>FrÃ¼h/Normal/SpÃ¤t/Nacht</span>
        </div>
        <div class="context-item">
          <span>Status:</span>
          <span style="color: var(--success);">Bereit fÃ¼r Optimierung</span>
        </div>
      </div>
    </div>
    
    <!-- Verlauf -->
    <div class="sidebar-section">
      <h4>ğŸ“œ GesprÃ¤ch</h4>
      <div style="font-size: 0.9rem; color: var(--text-light);">
        <div style="margin-bottom: 0.8rem; padding: 0.8rem; background: var(--background); border-radius: 0.8rem;">
          <strong>Nachrichten:</strong> <span id="messageCount">1</span>
        </div>
        <div style="margin-bottom: 0.8rem; padding: 0.8rem; background: var(--background); border-radius: 0.8rem;">
          <strong>Themen behandelt:</strong>
          <div id="topicsDiscussed" style="margin-top: 0.5rem; font-size: 0.8rem;">
            â€¢ EinfÃ¼hrung
          </div>
        </div>
        <button onclick="exportConversation()" style="width: 100%; padding: 0.8rem; background: var(--primary); color: white; border: none; border-radius: 0.8rem; cursor: pointer; font-weight: 600;">
          ğŸ“¥ GesprÃ¤ch exportieren
        </button>
      </div>
    </div>
    
  </div>
</div>

<script>
// Globale Variablen
let conversationHistory = [];
let messageCount = 1;
let topicsDiscussed = new Set(['EinfÃ¼hrung']);

// Intelligente KI-Antworten Datenbank
const aiKnowledge = {
  // Schichtplanung Grundlagen
  scheduling: {
    keywords: ['schichtplan', 'planen', 'erstellen', 'aufstellen', 'organisieren'],
    responses: [
      "FÃ¼r einen effektiven Schichtplan sollten Sie diese Schritte befolgen:\n\n1. ğŸ“Š **Bedarfsanalyse**: Analysieren Sie Ihre Arbeitsbelastung zu verschiedenen Zeiten\n2. ğŸ‘¥ **Mitarbeiter-VerfÃ¼gbarkeit**: Erfassen Sie alle VerfÃ¼gbarkeiten und PrÃ¤ferenzen\n3. âš–ï¸ **Faire Verteilung**: Achten Sie auf gleichmÃ¤ÃŸige Verteilung von Wochenend- und Nachtschichten\n4. ğŸ“‹ **Gesetzliche Vorgaben**: BerÃ¼cksichtigen Sie Arbeitszeiten und Pausenregelungen\n5. ğŸ”„ **FlexibilitÃ¤t**: Planen Sie Puffer fÃ¼r kurzfristige Ã„nderungen\n\nMÃ¶chten Sie, dass ich Ihnen bei einem spezifischen Aspekt helfe?",
      
      "Ein optimaler Schichtplan berÃ¼cksichtigt mehrere Faktoren:\n\nğŸ¯ **Kernprinzipien:**\nâ€¢ Mitarbeiter-Wohlbefinden steht im Vordergrund\nâ€¢ Betriebliche Anforderungen werden erfÃ¼llt\nâ€¢ Faire Rotation zwischen allen Schichttypen\nâ€¢ Ausreichende Ruhezeiten zwischen Schichten\n\nğŸ“ˆ **Optimierungstipps:**\nâ€¢ Verwenden Sie Datenanalyse fÃ¼r Bedarfsprognosen\nâ€¢ BerÃ¼cksichtigen Sie individuelle Leistungskurven\nâ€¢ Planen Sie regelmÃ¤ÃŸige Team-Meetings fÃ¼r Feedback\n\nWelche spezifische Herausforderung haben Sie bei der Schichtplanung?"
    ]
  },
  
  // Fairness und Gerechtigkeit
  fairness: {
    keywords: ['fair', 'gerecht', 'gleichmÃ¤ÃŸig', 'verteilung', 'rotation'],
    responses: [
      "Fairness in der Schichtplanung ist essentiell fÃ¼r die Mitarbeiterzufriedenheit. Hier sind meine Empfehlungen:\n\nâš–ï¸ **Faire Verteilungsstrategien:**\nâ€¢ **Rotationssystem**: Jeder Mitarbeiter durchlÃ¤uft alle Schichttypen\nâ€¢ **Punktesystem**: Vergeben Sie Punkte fÃ¼r unbeliebte Schichten\nâ€¢ **WunschberÃ¼cksichtigung**: 70% WÃ¼nsche erfÃ¼llen, 30% Betrieb\nâ€¢ **Transparente Regeln**: Alle kennen die Verteilungskriterien\n\nğŸ“Š **Fairness-Metriken:**\nâ€¢ Anzahl Wochenendschichten pro Mitarbeiter\nâ€¢ Verteilung von Nacht- vs. Tagschichten\nâ€¢ Ãœberstunden-Balance\n\nSoll ich eine Fairness-Analyse Ihres aktuellen Plans durchfÃ¼hren?",
      
      "Echte Fairness geht Ã¼ber einfache Gleichverteilung hinaus:\n\nğŸ” **Fairness-Dimensionen:**\nâ€¢ **Quantitative Fairness**: Gleiche Anzahl schwerer Schichten\nâ€¢ **Qualitative Fairness**: BerÃ¼cksichtigung individueller UmstÃ¤nde\nâ€¢ **Zeitliche Fairness**: GleichmÃ¤ÃŸige Verteilung Ã¼ber lÃ¤ngere ZeitrÃ¤ume\nâ€¢ **PrÃ¤ferenz-Fairness**: BerÃ¼cksichtigung persÃ¶nlicher WÃ¼nsche\n\nğŸ’¡ **Best Practices:**\nâ€¢ FÃ¼hren Sie regelmÃ¤ÃŸige Fairness-Audits durch\nâ€¢ Lassen Sie Mitarbeiter bewerten und Feedback geben\nâ€¢ Dokumentieren Sie alle Verteilungsentscheidungen\nâ€¢ Schaffen Sie Ausgleichsmechanismen fÃ¼r NotfÃ¤lle\n\nIn welchem Bereich sehen Sie aktuell Unfairness?"
    ]
  },
  
  // Optimierung
  optimization: {
    keywords: ['optimieren', 'verbessern', 'effizienz', 'produktivitÃ¤t', 'performance'],
    responses: [
      "Lassen Sie uns Ihren Schichtplan systematisch optimieren:\n\nğŸ¯ **Optimierungs-Framework:**\n\n**1. Datensammlung (IST-Analyse)**\nâ€¢ Aktuelle Arbeitszeiten analysieren\nâ€¢ Ãœberstunden-Muster identifizieren\nâ€¢ Mitarbeiter-Feedback auswerten\nâ€¢ ProduktivitÃ¤tskennzahlen messen\n\n**2. Identifikation von Verbesserungspotenzialen**\nâ€¢ EngpÃ¤sse in bestimmten ZeitrÃ¤umen\nâ€¢ Ãœberbesetzung zu schwachen Zeiten\nâ€¢ Ungleiche Belastungsverteilung\n\n**3. OptimierungsmaÃŸnahmen**\nâ€¢ Intelligente SchichtÃ¼berlappungen\nâ€¢ Flexible Arbeitszeiten einfÃ¼hren\nâ€¢ Skillbasierte Zuordnung\n\nWelche KPIs sind fÃ¼r Sie am wichtigsten?",
      
      "Hier ist mein AI-gestÃ¼tzter Optimierungsansatz:\n\nğŸ¤– **Intelligente Optimierung:**\n\n**Algorithmus-Features:**\nâ€¢ Predictive Scheduling basierend auf historischen Daten\nâ€¢ Automatische KonfliktlÃ¶sung\nâ€¢ Echtzeit-Anpassungen bei Ã„nderungen\nâ€¢ Multi-Kriterien-Optimierung (Kosten, Fairness, Effizienz)\n\n**Konkrete Verbesserungen:**\nâ€¢ 15-20% Reduktion von Ãœberstunden\nâ€¢ 30% weniger Planungszeit\nâ€¢ Verbesserte Work-Life-Balance\nâ€¢ HÃ¶here Mitarbeiterzufriedenheit\n\nSoll ich eine Optimierungsanalyse Ihrer aktuellen Daten durchfÃ¼hren?"
    ]
  },
  
  // Probleme und Konflikte
  problems: {
    keywords: ['problem', 'konflikt', 'schwierigkeit', 'herausforderung', 'lÃ¶sung'],
    responses: [
      "Ich helfe Ihnen gerne bei der ProblemlÃ¶sung! Hier sind die hÃ¤ufigsten Schichtplanungs-Probleme und LÃ¶sungsansÃ¤tze:\n\nâš ï¸ **Typische Probleme & LÃ¶sungen:**\n\n**Problem: HÃ¤ufige Krankmeldungen**\nâ†’ LÃ¶sung: Flexible Vertretungsregelungen, GesundheitsfÃ¶rderung\n\n**Problem: Unzufriedenheit mit Schichtverteilung**\nâ†’ LÃ¶sung: Transparente Kommunikation, Mitbestimmung\n\n**Problem: Ãœberstunden hÃ¤ufen sich**\nâ†’ LÃ¶sung: Bessere Bedarfsprognose, Springer-Pool\n\n**Problem: Work-Life-Balance leidet**\nâ†’ LÃ¶sung: LÃ¤ngere freie BlÃ¶cke, WunschberÃ¼cksichtigung\n\nBeschreiben Sie mir Ihr spezifisches Problem detaillierter!",
      
      "Probleme in der Schichtplanung erfordern systematische LÃ¶sungsansÃ¤tze:\n\nğŸ”§ **ProblemlÃ¶sungs-Methodik:**\n\n**1. Problemanalyse**\nâ€¢ Root-Cause-Analyse durchfÃ¼hren\nâ€¢ Alle Stakeholder befragen\nâ€¢ Daten sammeln und auswerten\n\n**2. LÃ¶sungsentwicklung**\nâ€¢ Multiple LÃ¶sungsoptionen entwickeln\nâ€¢ Machbarkeit und Auswirkungen bewerten\nâ€¢ Pilotprojekte durchfÃ¼hren\n\n**3. Implementierung & Monitoring**\nâ€¢ Schrittweise Umsetzung\nâ€¢ Kontinuierliches Feedback\nâ€¢ Anpassungen vornehmen\n\nWas ist Ihr aktuell grÃ¶ÃŸtes Problem bei der Schichtplanung?"
    ]
  },
  
  // Ãœberstunden
  overtime: {
    keywords: ['Ã¼berstunden', 'mehrarbeit', 'zu viel arbeit', 'arbeitszeit'],
    responses: [
      "Ãœberstunden-Management ist crucial fÃ¼r nachhaltiges Personal-Management:\n\nâ° **Anti-Ãœberstunden-Strategie:**\n\n**PrÃ¤ventive MaÃŸnahmen:**\nâ€¢ ğŸ“Š Bedarfsprognose basierend auf historischen Daten\nâ€¢ ğŸ‘¥ Aufbau einer flexiblen Springer-Reserve (10-15%)\nâ€¢ ğŸ”„ Kreuzqualifizierung der Mitarbeiter\nâ€¢ ğŸ“± Echtzeit-Monitoring der Arbeitszeiten\n\n**SofortmaÃŸnahmen bei Ãœberstunden:**\nâ€¢ Umverteilung auf andere Schichten\nâ€¢ Externe temporÃ¤re UnterstÃ¼tzung\nâ€¢ Priorisierung der wichtigsten Aufgaben\nâ€¢ Freizeitausgleich statt Bezahlung\n\nğŸ’¡ **Langfristige LÃ¶sung:** Implementierung eines predictive Scheduling-Systems, das Ãœberstunden um bis zu 40% reduzieren kann.\n\nWie hoch ist Ihr aktueller Ãœberstunden-Anteil?",
      
      "Hier ist mein systematischer Ansatz zur Ãœberstunden-Reduzierung:\n\nğŸ“ˆ **Ãœberstunden-Analyse-Framework:**\n\n**Phase 1: Diagnose (Woche 1-2)**\nâ€¢ Ãœberstunden-Hotspots identifizieren\nâ€¢ Ursachen kategorisieren (Planung vs. Ungeplant)\nâ€¢ Kosten-Nutzen-Analyse durchfÃ¼hren\n\n**Phase 2: Optimierung (Woche 3-4)**\nâ€¢ SchichtlÃ¤ngen anpassen\nâ€¢ Ãœberlappungszeiten optimieren\nâ€¢ Skill-Matrix erstellen fÃ¼r bessere Zuordnung\n\n**Phase 3: Monitoring (Ongoing)**\nâ€¢ WÃ¶chentliche Ãœberstunden-Reports\nâ€¢ FrÃ¼hwarnsystem implementieren\nâ€¢ Mitarbeiter-Feedback einbeziehen\n\nğŸ¯ **Ziel:** Reduktion der Ãœberstunden um 35% in 8 Wochen.\n\nSoll ich eine detaillierte Analyse Ihrer Ãœberstunden-Situation durchfÃ¼hren?"
    ]
  },
  
  // Urlaub und Abwesenheit
  vacation: {
    keywords: ['urlaub', 'abwesenheit', 'frei', 'fehlzeit', 'krank'],
    responses: [
      "Urlaubs- und Abwesenheitsplanung ist ein komplexes Optimierungsproblem:\n\nğŸ–ï¸ **Strategische Urlaubsplanung:**\n\n**Planungsprinzipien:**\nâ€¢ ğŸ“… FrÃ¼he Jahresplanung (Januar) mit Haupturlaubszeiten\nâ€¢ ğŸ¯ Maximum 30% der Belegschaft gleichzeitig im Urlaub\nâ€¢ âš–ï¸ Faire Verteilung von Ferienzeiten und BrÃ¼ckentagen\nâ€¢ ğŸ”„ Rotierendes System fÃ¼r begehrte Termine\n\n**Abwesenheits-Management:**\nâ€¢ Krankenstand-Monitoring und Trend-Analyse\nâ€¢ PrÃ¤ventive GesundheitsmaÃŸnahmen\nâ€¢ Schnelle Vertretungsregelungen\nâ€¢ Dokumentation aller Fehlzeiten\n\nğŸ’¡ **Smart-Tip:** Implementieren Sie ein digitales Urlaubsantrag-System mit automatischer KonfliktprÃ¼fung.\n\nWie handhaben Sie aktuell Ihre Urlaubsplanung?",
      
      "Hier ist mein AI-Ansatz fÃ¼r optimales Abwesenheits-Management:\n\nğŸ¤– **Intelligente Abwesenheits-Vorhersage:**\n\n**Predictive Analytics:**\nâ€¢ Krankenstand-Prognosen basierend auf Saison, Wetter, Stress-Level\nâ€¢ Urlaubstrends und -prÃ¤ferenzen analysieren\nâ€¢ Automatische Risiko-Bewertung fÃ¼r kritische Perioden\n\n**Adaptive Planung:**\nâ€¢ Dynamische Umplanung bei kurzfristigen AusfÃ¤llen\nâ€¢ Optimierte VertretungsvorschlÃ¤ge\nâ€¢ Skill-basierte Ersatzplanung\n\n**PrÃ¤ventive MaÃŸnahmen:**\nâ€¢ Work-Life-Balance Monitoring\nâ€¢ FrÃ¼hwarnsystem fÃ¼r Burnout-Risiko\nâ€¢ GesundheitsfÃ¶rderung basierend auf Abwesenheits-Mustern\n\nğŸ“Š **Ergebnis:** Bis zu 25% weniger ungeplante Abwesenheiten durch proaktives Management.\n\nMÃ¶chten Sie, dass ich Ihre Abwesenheitsmuster analysiere?"
    ]
  },
  
  // Mitarbeiter-PrÃ¤ferenzen
  preferences: {
    keywords: ['wunsch', 'prÃ¤ferenz', 'bevorzugung', 'mitarbeiter wollen', 'individuelle'],
    responses: [
      "Mitarbeiter-PrÃ¤ferenzen intelligent zu berÃ¼cksichtigen ist der SchlÃ¼ssel zur Zufriedenheit:\n\nğŸ‘¥ **PrÃ¤ferenz-Management-System:**\n\n**Erfassung von PrÃ¤ferenzen:**\nâ€¢ ğŸ“‹ Detaillierte Wunsch-Profile erstellen\nâ€¢ ğŸ¯ Gewichtung nach Wichtigkeit (1-10 Skala)\nâ€¢ ğŸ“… ZeitrÃ¤ume definieren (dauerhaft vs. temporÃ¤r)\nâ€¢ ğŸ’¡ BegrÃ¼ndungen verstehen und dokumentieren\n\n**Intelligente BerÃ¼cksichtigung:**\nâ€¢ 70% Wunsch-ErfÃ¼llung als Ziel\nâ€¢ Fairness-Index fÃ¼r Wunsch-Verteilung\nâ€¢ Kompromiss-VorschlÃ¤ge bei Konflikten\nâ€¢ Langfristige Ausgleichsmechanismen\n\n**Kommunikation:**\nâ€¢ Transparente ErklÃ¤rung bei Nicht-ErfÃ¼llung\nâ€¢ Alternative LÃ¶sungsvorschlÃ¤ge anbieten\nâ€¢ RegelmÃ¤ÃŸige PrÃ¤ferenz-Updates ermÃ¶glichen\n\nWie erfassen Sie aktuell die WÃ¼nsche Ihrer Mitarbeiter?",
      
      "Hier ist mein wissenschaftlicher Ansatz fÃ¼r PrÃ¤ferenz-Optimierung:\n\nğŸ§  **Psychologische Aspekte:**\n\n**Motivations-Theorie:**\nâ€¢ Autonomie: Mitspracherecht bei der Schichtplanung\nâ€¢ Competence: Passende Aufgaben zu den FÃ¤higkeiten\nâ€¢ Relatedness: BerÃ¼cksichtigung von TeamwÃ¼nschen\n\n**PrÃ¤ferenz-Kategorien:**\nâ€¢ ğŸ• Zeitliche PrÃ¤ferenzen (FrÃ¼h vs. SpÃ¤t)\nâ€¢ ğŸ‘« Soziale PrÃ¤ferenzen (Team-Zusammenstellung)\nâ€¢ ğŸ“ Arbeitsplatz-PrÃ¤ferenzen (Standort, Bereich)\nâ€¢ ğŸ”„ Rotations-PrÃ¤ferenzen (Abwechslung vs. Routine)\n\n**Optimierungs-Algorithmus:**\nâ€¢ Multi-objektive Optimierung\nâ€¢ Pareto-Effizienz zwischen individuellen und betrieblichen Zielen\nâ€¢ Maschinelles Lernen zur PrÃ¤ferenz-Vorhersage\n\nğŸ¯ **Ziel:** 85%+ Zufriedenheit bei gleichzeitiger Betriebseffizienz.\n\nSoll ich ein PrÃ¤ferenz-Analyse-System fÃ¼r Sie entwickeln?"
    ]
  }
};

// Allgemeine Antworten fÃ¼r unbekannte Fragen
const generalResponses = [
  "Das ist eine interessante Frage zur Schichtplanung! KÃ¶nnen Sie mir mehr Details geben? Je spezifischer Sie sind, desto besser kann ich Ihnen helfen.\n\nğŸ¤” **Hilfreiche Informationen wÃ¤ren:**\nâ€¢ Wie viele Mitarbeiter haben Sie?\nâ€¢ Welche Schichtarten verwenden Sie?\nâ€¢ Was ist Ihr konkretes Ziel?\nâ€¢ Welche Herausforderungen haben Sie aktuell?\n\nMit diesen Informationen kann ich Ihnen eine maÃŸgeschneiderte LÃ¶sung vorschlagen!",
  
  "Als KI-Experte fÃ¼r Schichtplanung bin ich spezialisiert auf die Optimierung von ArbeitsablÃ¤ufen. Ihre Frage berÃ¼hrt ein wichtiges Thema!\n\nğŸ’¡ **Meine Expertise umfasst:**\nâ€¢ Algorithmusbasierte Schichtoptimierung\nâ€¢ Fairness-Analysen und -Verbesserungen\nâ€¢ ProduktivitÃ¤tssteigerung durch intelligente Planung\nâ€¢ Mitarbeiterzufriedenheit maximieren\nâ€¢ Kostenoptimierung bei Personalplanung\n\nKÃ¶nnen Sie Ihre Frage prÃ¤zisieren, damit ich Ihnen eine detaillierte, datenbasierte Antwort geben kann?",
  
  "Excellent! Sie sprechen einen wichtigen Aspekt der modernen Personalplanung an. Lassen Sie uns das systematisch angehen:\n\nğŸ¯ **Mein Ansatz:**\n1. **Situationsanalyse:** Was ist Ihr aktueller Stand?\n2. **Zieldefinition:** Was mÃ¶chten Sie erreichen?\n3. **LÃ¶sungsentwicklung:** MaÃŸgeschneiderte Strategien\n4. **Umsetzungsplan:** Schritt-fÃ¼r-Schritt Anleitung\n5. **Monitoring:** Erfolgsmessung und Anpassung\n\nTeilen Sie mir mehr Details mit, damit ich Ihnen eine spezifische, umsetzbare LÃ¶sung vorschlagen kann!"
];

// Intelligente Antwort-Generierung
function generateAIResponse(message) {
  const lowerMessage = message.toLowerCase();
  
  // Durchsuche Wissensdatenbank nach passenden Keywords
  for (const [category, data] of Object.entries(aiKnowledge)) {
    for (const keyword of data.keywords) {
      if (lowerMessage.includes(keyword)) {
        // ZufÃ¤llige Antwort aus der Kategorie wÃ¤hlen
        const response = data.responses[Math.floor(Math.random() * data.responses.length)];
        addTopic(category);
        return response;
      }
    }
  }
  
  // Spezielle Muster erkennen
  if (lowerMessage.includes('team a') || lowerMessage.includes('team b') || lowerMessage.includes('team c') || lowerMessage.includes('team d')) {
    addTopic('Team-Management');
    return generateTeamSpecificResponse(message);
  }
  
  if (lowerMessage.includes('ki') || lowerMessage.includes('kÃ¼nstliche intelligenz') || lowerMessage.includes('algorithmus')) {
    addTopic('KI-Features');
    return generateAIFeatureResponse(message);
  }
  
  if (lowerMessage.includes('kosten') || lowerMessage.includes('budget') || lowerMessage.includes('sparen')) {
    addTopic('Kostenoptimierung');
    return generateCostResponse(message);
  }
  
  // Fallback: Allgemeine Antwort
  addTopic('Allgemeine Beratung');
  return generalResponses[Math.floor(Math.random() * generalResponses.length)];
}

// Spezielle Antwort-Generatoren
function generateTeamSpecificResponse(message) {
  return `Ich sehe, Sie sprechen Ã¼ber spezifische Teams! Hier ist meine Analyse:\n\nğŸ‘¥ **Team-spezifische Optimierung:**\n\n**Aktuelle Team-Konfiguration:**\nâ€¢ Team A: Starkes FrÃ¼hschicht-Team (empfohlen: 6:00-14:00)\nâ€¢ Team B: Flexibles Vollzeit-Team (empfohlen: 8:00-16:00)\nâ€¢ Team C: SpÃ¤tschicht-Spezialist (empfohlen: 14:00-22:00)\nâ€¢ Team D: Nachtschicht-Rotation (empfohlen: 22:00-6:00)\n\nğŸ¯ **OptimierungsvorschlÃ¤ge:**\nâ€¢ Cross-Training zwischen Teams fÃ¼r mehr FlexibilitÃ¤t\nâ€¢ RegelmÃ¤ÃŸige Team-Rotation (alle 3 Monate)\nâ€¢ Skill-Matrix basierte Zuordnungen\nâ€¢ Team-Performance-Monitoring\n\nğŸ“Š **Erwartete Verbesserungen:**\nâ€¢ +15% ProduktivitÃ¤t durch optimale Team-Zeit-Zuordnung\nâ€¢ +25% Mitarbeiterzufriedenheit\nâ€¢ -20% ungeplante Ãœberstunden\n\nSoll ich eine detaillierte Team-Analyse fÃ¼r Sie durchfÃ¼hren?`;
}

function generateAIFeatureResponse(message) {
  return `Exzellent! Sie interessieren sich fÃ¼r die KI-Features. Hier sind meine erweiterten FÃ¤higkeiten:\n\nğŸ¤– **Advanced AI Capabilities:**\n\n**Machine Learning Features:**\nâ€¢ ğŸ“ˆ Predictive Analytics fÃ¼r Personalbedarfsprognosen\nâ€¢ ğŸ” Pattern Recognition in Arbeitszeit-Daten\nâ€¢ ğŸ¯ Personalized Recommendations fÃ¼r jeden Mitarbeiter\nâ€¢ âš¡ Real-time Optimization bei PlanungsÃ¤nderungen\n\n**Algorithmus-Portfolio:**\nâ€¢ Genetic Algorithm fÃ¼r optimale Schichtverteilung\nâ€¢ Neural Networks fÃ¼r Krankenstand-Vorhersage\nâ€¢ Constraint Satisfaction fÃ¼r Regel-Compliance\nâ€¢ Multi-objective Optimization fÃ¼r Zielkonflikte\n\n**Intelligente Features:**\nâ€¢ Automatische KonfliktlÃ¶sung\nâ€¢ Fairness-Scoring mit Bias-Erkennung\nâ€¢ Sentiment-Analyse aus Mitarbeiter-Feedback\nâ€¢ Predictive Burnout-Prevention\n\nğŸš€ **Next-Gen Features in Entwicklung:**\nâ€¢ Integration mit IoT-Sensoren fÃ¼r Arbeitsplatz-Optimierung\nâ€¢ Voice-Interface fÃ¼r natÃ¼rliche Planungsanfragen\nâ€¢ AR/VR Visualisierung komplexer SchichtplÃ¤ne\n\nWelche KI-Features interessieren Sie am meisten?`;
}

function generateCostResponse(message) {
  return `Kostenoptimierung ist ein SchlÃ¼sselaspekt erfolgreicher Schichtplanung! Hier meine Analyse:\n\nğŸ’° **ROI-orientierte Schichtplanung:**\n\n**Kostenfaktoren identifizieren:**\nâ€¢ ğŸ“Š Ãœberstunden-Kosten (oft 25-50% hÃ¶her als Normalstunden)\nâ€¢ ğŸ¥ Krankheitsbedingte Ausfallkosten\nâ€¢ ğŸ”„ Rekrutierung und Einarbeitung\nâ€¢ âš¡ ProduktivitÃ¤tsverluste durch suboptimale Planung\n\n**Einsparungspotentiale:**\nâ€¢ âœ‚ï¸ 30% Ãœberstunden-Reduktion = â‚¬12.000/Jahr (bei 10 Mitarbeitern)\nâ€¢ ğŸ“ˆ 20% ProduktivitÃ¤tssteigerung durch optimale Zuordnung\nâ€¢ ğŸ¥ 15% weniger krankheitsbedingte AusfÃ¤lle\nâ€¢ â±ï¸ 60% weniger Planungszeit fÃ¼r Manager\n\n**ROI-Berechnung fÃ¼r KI-Schichtplanung:**\nâ€¢ Investition: ~â‚¬2.000 Setup + â‚¬200/Monat\nâ€¢ Einsparungen: ~â‚¬15.000-25.000/Jahr\nâ€¢ **Break-Even: 3-4 Monate**\nâ€¢ **ROI nach 12 Monaten: 400-800%**\n\nğŸ“Š Soll ich eine detaillierte Kosten-Nutzen-Analyse fÃ¼r Ihr Unternehmen erstellen?`;
}

// Chat-FunktionalitÃ¤t
function addMessage(content, isUser = false, timestamp = new Date()) {
  const messagesContainer = document.getElementById('chatMessages');
  const messageDiv = document.createElement('div');
  messageDiv.className = `message ${isUser ? 'user' : 'ai'}`;
  
  const timeString = timestamp.toLocaleTimeString('de-DE', { 
    hour: '2-digit', 
    minute: '2-digit' 
  });
  
  messageDiv.innerHTML = `
    <div class="message-avatar">${isUser ? 'ğŸ‘¤' : 'ğŸ¤–'}</div>
    <div class="message-content">
      ${content.replace(/\n/g, '<br>')}
      <div class="message-time">${timeString}</div>
    </div>
  `;
  
  // Typing indicator entfernen
  const typingIndicator = document.getElementById('typingIndicator');
  typingIndicator.style.display = 'none';
  
  messagesContainer.appendChild(messageDiv);
  messagesContainer.scrollTop = messagesContainer.scrollHeight;
  
  // Konversation speichern
  conversationHistory.push({
    content,
    isUser,
    timestamp
  });
  
  // Message count aktualisieren
  messageCount++;
  document.getElementById('messageCount').textContent = messageCount;
}

function showTypingIndicator() {
  const typingIndicator = document.getElementById('typingIndicator');
  typingIndicator.style.display = 'flex';
  
  const messagesContainer = document.getElementById('chatMessages');
  messagesContainer.scrollTop = messagesContainer.scrollHeight;
}

function addTopic(topic) {
  topicsDiscussed.add(topic);
  updateTopicsDisplay();
}

function updateTopicsDisplay() {
  const topicsElement = document.getElementById('topicsDiscussed');
  topicsElement.innerHTML = Array.from(topicsDiscussed)
    .map(topic => `â€¢ ${topic}`)
    .join('<br>');
}

// Nachricht senden
async function sendMessage() {
  const input = document.getElementById('chatInput');
  const message = input.value.trim();
  
  if (!message) return;
  
  // User message hinzufÃ¼gen
  addMessage(message, true);
  input.value = '';
  
  // Typing indicator zeigen
  showTypingIndicator();
  
  // Realistische VerzÃ¶gerung fÃ¼r KI-Verarbeitung
  const delay = Math.max(1000, Math.min(4000, message.length * 50));
  
  setTimeout(() => {
    const response = generateAIResponse(message);
    addMessage(response, false);
  }, delay);
  
  // Input zurÃ¼cksetzen
  adjustTextareaHeight();
}

// Schnelle Fragen
function askQuickQuestion(question) {
  document.getElementById('chatInput').value = question;
  sendMessage();
}

// Textarea Auto-Resize
function adjustTextareaHeight() {
  const textarea = document.getElementById('chatInput');
  textarea.style.height = 'auto';
  textarea.style.height = Math.min(textarea.scrollHeight, 120) + 'px';
}

// GesprÃ¤ch exportieren
function exportConversation() {
  const conversationText = conversationHistory
    .map(msg => `${msg.isUser ? 'Sie' : 'KI-Assistent'} (${msg.timestamp.toLocaleString('de-DE')}):\n${msg.content}\n`)
    .join('\n---\n\n');
  
  const blob = new Blob([conversationText], { type: 'text/plain;charset=utf-8' });
  const url = window.URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = `ki-gespraech-${new Date().toISOString().split('T')[0]}.txt`;
  a.click();
  window.URL.revokeObjectURL(url);
  
  showNotification('ğŸ“¥ GesprÃ¤ch exportiert!');
}

// Hilfsfunktionen
function showNotification(message) {
  const notification = document.createElement('div');
  notification.style.cssText = `
    position: fixed;
    top: 20px;
    right: 20px;
    background: var(--ai-gradient);
    color: white;
    padding: 1rem 1.5rem;
    border-radius: 1rem;
    font-weight: 600;
    z-index: 1001;
    animation: slideInRight 0.5s ease;
    box-shadow: var(--shadow);
    max-width: 300px;
  `;
  notification.textContent = message;
  document.body.appendChild(notification);
  
  setTimeout(() => {
    notification.style.animation = 'slideOutRight 0.3s ease';
    setTimeout(() => notification.remove(), 300);
  }, 3000);
}

// Event Listeners
document.addEventListener('DOMContentLoaded', function() {
  const chatInput = document.getElementById('chatInput');
  const sendBtn = document.getElementById('sendBtn');
  
  // Auto-resize fÃ¼r Textarea
  chatInput.addEventListener('input', adjustTextareaHeight);
  
  // Enter zum Senden
  chatInput.addEventListener('keydown', function(e) {
    if (e.key === 'Enter' && !e.shiftKey) {
      e.preventDefault();
      sendMessage();
    }
  });
  
  // Send Button
  sendBtn.addEventListener('click', sendMessage);
  
  // Initial height
  adjustTextareaHeight();
});

// Animationen
const style = document.createElement('style');
style.textContent = `
  @keyframes slideInRight {
    from { opacity: 0; transform: translateX(100px); }
    to { opacity: 1; transform: translateX(0); }
  }
  
  @keyframes slideOutRight {
    from { opacity: 1; transform: translateX(0); }
    to { opacity: 0; transform: translateX(100px); }
  }
`;
document.head.appendChild(style);
</script>

</body>
</html>