<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>KI-Assistent - PlanPal KI</title>
<link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700&display=swap" rel="stylesheet">
<style>
:root {
  --primary: #2563eb;
  --secondary: #06b6d4;
  --accent: #f59e0b;
  --success: #10b981;
  --danger: #ef4444;
  --background: #f9fafb;
  --surface: #ffffff;
  --text-dark: #111827;
  --text-light: #6b7280;
  --radius: 1.5rem;
  --shadow: 0 8px 24px rgba(0,0,0,0.08);
  --border: #e5e7eb;
  --ai-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
}

* {margin:0; padding:0; box-sizing:border-box;}
body {
  font-family:'Nunito', sans-serif;
  background: var(--background);
  color:var(--text-dark);
  min-height: 100vh;
}

/* HEADER */
header {
  background: var(--ai-gradient);
  color: white;
  box-shadow: var(--shadow);
  padding: 1rem 2rem;
  display: flex;
  justify-content: space-between;
  align-items: center;
  position: sticky;
  top: 0;
  z-index: 50;
}

.logo-container {
  display: flex;
  align-items: center;
}

.logo-container img {
  height: 45px;
  margin-right: 12px;
  filter: brightness(0) invert(1);
}

.logo-container h1 {
  font-size: 1.8rem;
  font-weight: 800;
}

.header-nav {
  display: flex;
  align-items: center;
  gap: 1.5rem;
}

.back-btn {
  background: rgba(255,255,255,0.2);
  color: white;
  border: 1px solid rgba(255,255,255,0.3);
  padding: 0.6rem 1.2rem;
  border-radius: 0.8rem;
  font-weight: 600;
  cursor: pointer;
  text-decoration: none;
  display: flex;
  align-items: center;
  gap: 0.5rem;
  transition: all 0.3s;
  backdrop-filter: blur(10px);
}

.back-btn:hover {
  background: rgba(255,255,255,0.3);
  transform: translateY(-2px);
}

/* MAIN CONTAINER */
.main-container {
  max-width: 1200px;
  margin: 2rem auto;
  padding: 0 2rem;
  display: grid;
  grid-template-columns: 1fr 350px;
  gap: 2rem;
  min-height: calc(100vh - 120px);
}

/* CHAT MAIN */
.chat-main {
  background: var(--surface);
  border-radius: var(--radius);
  box-shadow: var(--shadow);
  height: calc(100vh - 200px);
  display: flex;
  flex-direction: column;
  overflow: hidden;
}

.chat-header {
  background: var(--ai-gradient);
  color: white;
  padding: 1.5rem 2rem;
  display: flex;
  align-items: center;
  gap: 1rem;
}

.ai-avatar {
  width: 50px;
  height: 50px;
  background: rgba(255,255,255,0.2);
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 1.5rem;
}

.ai-info h3 {
  font-size: 1.3rem;
  margin-bottom: 0.3rem;
}

.ai-info p {
  opacity: 0.9;
  font-size: 0.9rem;
}

.ai-status {
  margin-left: auto;
  display: flex;
  align-items: center;
  gap: 0.5rem;
  font-size: 0.9rem;
}

.status-dot {
  width: 8px;
  height: 8px;
  background: #10b981;
  border-radius: 50%;
  animation: pulse 2s infinite;
}

@keyframes pulse {
  0% { opacity: 1; }
  50% { opacity: 0.5; }
  100% { opacity: 1; }
}

/* CHAT MESSAGES */
.chat-messages {
  flex: 1;
  padding: 1.5rem;
  overflow-y: auto;
  background: linear-gradient(180deg, #fafbff 0%, #f8fafc 100%);
}

.message {
  margin-bottom: 1.5rem;
  display: flex;
  gap: 1rem;
}

.message.user {
  flex-direction: row-reverse;
}

.message-avatar {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 1.2rem;
  flex-shrink: 0;
}

.message.ai .message-avatar {
  background: var(--ai-gradient);
  color: white;
}

.message.user .message-avatar {
  background: var(--primary);
  color: white;
}

.message-content {
  background: white;
  padding: 1rem 1.5rem;
  border-radius: 1.5rem;
  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
  max-width: 70%;
  position: relative;
}

.message.ai .message-content {
  background: linear-gradient(135deg, #f8faff 0%, #f1f5ff 100%);
  border: 1px solid #e0e7ff;
}

.message.user .message-content {
  background: var(--primary);
  color: white;
}

.message-time {
  font-size: 0.75rem;
  opacity: 0.7;
  margin-top: 0.5rem;
}

.typing-indicator {
  display: none;
  align-items: center;
  gap: 0.5rem;
  font-style: italic;
  color: var(--text-light);
}

.typing-dots {
  display: flex;
  gap: 0.2rem;
}

.typing-dot {
  width: 6px;
  height: 6px;
  background: var(--text-light);
  border-radius: 50%;
  animation: typing 1.4s infinite;
}

.typing-dot:nth-child(2) { animation-delay: 0.2s; }
.typing-dot:nth-child(3) { animation-delay: 0.4s; }

@keyframes typing {
  0%, 60% { opacity: 0.3; }
  30% { opacity: 1; }
}

/* CHAT INPUT */
.chat-input-container {
  padding: 1.5rem;
  background: white;
  border-top: 1px solid var(--border);
}

.chat-input-wrapper {
  display: flex;
  gap: 1rem;
  align-items: end;
}

.chat-input {
  flex: 1;
  min-height: 50px;
  max-height: 120px;
  padding: 1rem;
  border: 2px solid var(--border);
  border-radius: 1.5rem;
  font-family: 'Nunito', sans-serif;
  resize: none;
  transition: all 0.3s;
  font-size: 1rem;
  line-height: 1.4;
}

.chat-input:focus {
  outline: none;
  border-color: var(--primary);
  box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
}

.send-btn {
  background: var(--ai-gradient);
  color: white;
  border: none;
  width: 50px;
  height: 50px;
  border-radius: 50%;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 1.2rem;
  transition: all 0.3s;
  flex-shrink: 0;
}

.send-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 12px rgba(102, 126, 234, 0.3);
}

.send-btn:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

/* SIDEBAR */
.ai-sidebar {
  display: flex;
  flex-direction: column;
  gap: 1.5rem;
  height: fit-content;
  position: sticky;
  top: 100px;
}

.sidebar-section {
  background: var(--surface);
  border-radius: var(--radius);
  padding: 1.5rem;
  box-shadow: var(--shadow);
}

.sidebar-section h4 {
  color: var(--primary);
  margin-bottom: 1rem;
  font-weight: 700;
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

/* QUICK SUGGESTIONS */
.suggestions-grid {
  display: grid;
  gap: 0.8rem;
}

.suggestion-btn {
  background: linear-gradient(135deg, #f0f4ff 0%, #e0e7ff 100%);
  border: 1px solid #c7d2fe;
  color: var(--primary);
  padding: 1rem;
  border-radius: 1rem;
  cursor: pointer;
  text-align: left;
  font-weight: 600;
  transition: all 0.3s;
  font-size: 0.9rem;
}

.suggestion-btn:hover {
  background: linear-gradient(135deg, #e0e7ff 0%, #c7d2fe 100%);
  transform: translateY(-2px);
  box-shadow: 0 4px 8px rgba(0,0,0,0.1);
}

/* AI CAPABILITIES */
.capability-item {
  display: flex;
  align-items: center;
  gap: 0.8rem;
  padding: 0.8rem;
  background: var(--background);
  border-radius: 0.8rem;
  margin-bottom: 0.8rem;
  border-left: 3px solid var(--success);
}

.capability-icon {
  font-size: 1.2rem;
  opacity: 0.8;
}

.capability-text {
  font-size: 0.9rem;
  font-weight: 600;
}

/* CONTEXT DISPLAY */
.context-info {
  background: var(--background);
  padding: 1rem;
  border-radius: 1rem;
  font-size: 0.85rem;
  color: var(--text-light);
}

.context-item {
  display: flex;
  justify-content: space-between;
  margin-bottom: 0.5rem;
}

.context-item:last-child {
  margin-bottom: 0;
}

/* RESPONSIVE */
@media(max-width:1024px){
  .main-container {
    grid-template-columns: 1fr;
    gap: 2rem;
  }
  
  .ai-sidebar {
    position: static;
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 1.5rem;
  }
  
  .chat-main {
    height: 70vh;
  }
}

@media(max-width:768px){
  .main-container {
    padding: 0 1rem;
    margin: 1rem auto;
  }
  
  .chat-header {
    padding: 1rem;
    flex-direction: column;
    text-align: center;
    gap: 0.5rem;
  }
  
  .ai-status {
    margin-left: 0;
  }
  
  .message-content {
    max-width: 85%;
  }
  
  header {
    flex-direction: column;
    text-align: center;
    padding: 1rem;
  }
  
  .header-nav {
    margin-top: 1rem;
  }
  
  .logo-container h1 {
    font-size: 1.4rem;
  }
}
</style>
</head>
<body>

<header>
  <div class="logo-container">
    <img src="logo.png" alt="PlanPal Logo">
    <h1>ü§ñ PlanPal KI-Assistent</h1>
  </div>
  <div class="header-nav">
    <a href="schichtplaner.html" class="back-btn">üìÖ Schichtplaner</a>
    <a href="index.html" class="back-btn">‚Üê Zur Hauptseite</a>
  </div>
</header>

<div class="main-container">
  <!-- Chat Hauptbereich -->
  <div class="chat-main">
    <div class="chat-header">
      <div class="ai-avatar">ü§ñ</div>
      <div class="ai-info">
        <h3>KI-Schichtplaner Assistent</h3>
        <p>Intelligente Planung f√ºr optimale Arbeitsabl√§ufe</p>
      </div>
      <div class="ai-status">
        <div class="status-dot"></div>
        <span>Online</span>
      </div>
    </div>
    
    <div class="chat-messages" id="chatMessages">
      <!-- Willkommensnachricht -->
      <div class="message ai">
        <div class="message-avatar">ü§ñ</div>
        <div class="message-content">
          <p>Hallo! Ich bin Ihr intelligenter Schichtplaner-Assistent. Ich kann Ihnen bei folgenden Aufgaben helfen:</p>
          <ul style="margin: 1rem 0; padding-left: 1.5rem;">
            <li>üìÖ Optimale Schichtpl√§ne erstellen</li>
            <li>‚öñÔ∏è Faire Arbeitszeiten-Verteilung</li>
            <li>üîç Konflikte und Probleme erkennen</li>
            <li>üìä Arbeitszeit-Analysen</li>
            <li>üí° Verbesserungsvorschl√§ge</li>
          </ul>
          <p>Stellen Sie mir einfach Ihre Frage oder beschreiben Sie Ihr Planungs-Problem!</p>
          <div class="message-time">Gerade eben</div>
        </div>
      </div>
      
      <!-- Typing Indicator -->
      <div class="message ai typing-indicator" id="typingIndicator">
        <div class="message-avatar">ü§ñ</div>
        <div class="message-content">
          <div class="typing-indicator">
            KI denkt nach
            <div class="typing-dots">
              <div class="typing-dot"></div>
              <div class="typing-dot"></div>
              <div class="typing-dot"></div>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <div class="chat-input-container">
      <div class="chat-input-wrapper">
        <textarea 
          class="chat-input" 
          id="chatInput" 
          placeholder="Fragen Sie mich nach Schichtplanung, Optimierungen oder Problemen..."
          rows="1"
        ></textarea>
        <button class="send-btn" id="sendBtn" onclick="sendMessage()">
          ‚û§
        </button>
      </div>
    </div>
  </div>
  
  <!-- Sidebar -->
  <div class="ai-sidebar">
    
    <!-- Schnelle Fragen -->
    <div class="sidebar-section">
      <h4>üí° Schnelle Fragen</h4>
      <div class="suggestions-grid">
        <button class="suggestion-btn" onclick="askQuickQuestion('Wie erstelle ich einen fairen Schichtplan?')">
          Wie erstelle ich einen fairen Schichtplan?
        </button>
        <button class="suggestion-btn" onclick="askQuickQuestion('Optimiere meinen aktuellen Schichtplan')">
          Optimiere meinen aktuellen Schichtplan
        </button>
        <button class="suggestion-btn" onclick="askQuickQuestion('Wie vermeide ich √úberstunden?')">
          Wie vermeide ich √úberstunden?
        </button>
        <button class="suggestion-btn" onclick="askQuickQuestion('Urlaubsplanung ber√ºcksichtigen')">
          Urlaubsplanung ber√ºcksichtigen
        </button>
        <button class="suggestion-btn" onclick="askQuickQuestion('Mitarbeiter-Pr√§ferenzen einbauen')">
          Mitarbeiter-Pr√§ferenzen einbauen
        </button>
        <button class="suggestion-btn" onclick="askQuickQuestion('Nachtschichten fair verteilen')">
          Nachtschichten fair verteilen
        </button>
      </div>
    </div>
    
    <!-- KI F√§higkeiten -->
    <div class="sidebar-section">
      <h4>üß† KI-F√§higkeiten</h4>
      <div class="capability-item">
        <div class="capability-icon">üìà</div>
        <div class="capability-text">Mustererkennung in Arbeitszeiten</div>
      </div>
      <div class="capability-item">
        <div class="capability-icon">‚öñÔ∏è</div>
        <div class="capability-text">Automatische Fairness-Analyse</div>
      </div>
      <div class="capability-item">
        <div class="capability-icon">üîÆ</div>
        <div class="capability-text">Predictive Scheduling</div>
      </div>
      <div class="capability-item">
        <div class="capability-icon">üõ†Ô∏è</div>
        <div class="capability-text">Konfliktl√∂sung</div>
      </div>
      <div class="capability-item">
        <div class="capability-icon">üìä</div>
        <div class="capability-text">Echtzeit-Optimierung</div>
      </div>
    </div>
    
    <!-- Kontext -->
    <div class="sidebar-section">
      <h4>üìã Aktueller Kontext</h4>
      <div class="context-info" id="contextInfo">
        <div class="context-item">
          <span>Mitarbeiter:</span>
          <span>6 Personen</span>
        </div>
        <div class="context-item">
          <span>Teams:</span>
          <span>4 Teams (A-D)</span>
        </div>
        <div class="context-item">
          <span>Zeitraum:</span>
          <span>Aktueller Monat</span>
        </div>
        <div class="context-item">
          <span>Schichten:</span>
          <span>Fr√ºh/Normal/Sp√§t/Nacht</span>
        </div>
        <div class="context-item">
          <span>Status:</span>
          <span style="color: var(--success);">Bereit f√ºr Optimierung</span>
        </div>
      </div>
    </div>
    
    <!-- Verlauf -->
    <div class="sidebar-section">
      <h4>üìú Gespr√§ch</h4>
      <div style="font-size: 0.9rem; color: var(--text-light);">
        <div style="margin-bottom: 0.8rem; padding: 0.8rem; background: var(--background); border-radius: 0.8rem;">
          <strong>Nachrichten:</strong> <span id="messageCount">1</span>
        </div>
        <div style="margin-bottom: 0.8rem; padding: 0.8rem; background: var(--background); border-radius: 0.8rem;">
          <strong>Themen behandelt:</strong>
          <div id="topicsDiscussed" style="margin-top: 0.5rem; font-size: 0.8rem;">
            ‚Ä¢ Einf√ºhrung
          </div>
        </div>
        <button onclick="exportConversation()" style="width: 100%; padding: 0.8rem; background: var(--primary); color: white; border: none; border-radius: 0.8rem; cursor: pointer; font-weight: 600;">
          üì• Gespr√§ch exportieren
        </button>
      </div>
    </div>
    
  </div>
</div>

<script>
// Globale Variablen
let conversationHistory = [];
let messageCount = 1;
let topicsDiscussed = new Set(['Einf√ºhrung']);

// Intelligente KI-Antworten Datenbank
const aiKnowledge = {
  // Schichtplanung Grundlagen
  scheduling: {
    keywords: ['schichtplan', 'planen', 'erstellen', 'aufstellen', 'organisieren'],
    responses: [
      "F√ºr einen effektiven Schichtplan sollten Sie diese Schritte befolgen:\n\n1. üìä **Bedarfsanalyse**: Analysieren Sie Ihre Arbeitsbelastung zu verschiedenen Zeiten\n2. üë• **Mitarbeiter-Verf√ºgbarkeit**: Erfassen Sie alle Verf√ºgbarkeiten und Pr√§ferenzen\n3. ‚öñÔ∏è **Faire Verteilung**: Achten Sie auf gleichm√§√üige Verteilung von Wochenend- und Nachtschichten\n4. üìã **Gesetzliche Vorgaben**: Ber√ºcksichtigen Sie Arbeitszeiten und Pausenregelungen\n5. üîÑ **Flexibilit√§t**: Planen Sie Puffer f√ºr kurzfristige √Ñnderungen\n\nM√∂chten Sie, dass ich Ihnen bei einem spezifischen Aspekt helfe?",
      
      "Ein optimaler Schichtplan ber√ºcksichtigt mehrere Faktoren:\n\nüéØ **Kernprinzipien:**\n‚Ä¢ Mitarbeiter-Wohlbefinden steht im Vordergrund\n‚Ä¢ Betriebliche Anforderungen werden erf√ºllt\n‚Ä¢ Faire Rotation zwischen allen Schichttypen\n‚Ä¢ Ausreichende Ruhezeiten zwischen Schichten\n\nüìà **Optimierungstipps:**\n‚Ä¢ Verwenden Sie Datenanalyse f√ºr Bedarfsprognosen\n‚Ä¢ Ber√ºcksichtigen Sie individuelle Leistungskurven\n‚Ä¢ Planen Sie regelm√§√üige Team-Meetings f√ºr Feedback\n\nWelche spezifische Herausforderung haben Sie bei der Schichtplanung?"
    ]
  },
  
  // Fairness und Gerechtigkeit
  fairness: {
    keywords: ['fair', 'gerecht', 'gleichm√§√üig', 'verteilung', 'rotation'],
    responses: [
      "Fairness in der Schichtplanung ist essentiell f√ºr die Mitarbeiterzufriedenheit. Hier sind meine Empfehlungen:\n\n‚öñÔ∏è **Faire Verteilungsstrategien:**\n‚Ä¢ **Rotationssystem**: Jeder Mitarbeiter durchl√§uft alle Schichttypen\n‚Ä¢ **Punktesystem**: Vergeben Sie Punkte f√ºr unbeliebte Schichten\n‚Ä¢ **Wunschber√ºcksichtigung**: 70% W√ºnsche erf√ºllen, 30% Betrieb\n‚Ä¢ **Transparente Regeln**: Alle kennen die Verteilungskriterien\n\nüìä **Fairness-Metriken:**\n‚Ä¢ Anzahl Wochenendschichten pro Mitarbeiter\n‚Ä¢ Verteilung von Nacht- vs. Tagschichten\n‚Ä¢ √úberstunden-Balance\n\nSoll ich eine Fairness-Analyse Ihres aktuellen Plans durchf√ºhren?",
      
      "Echte Fairness geht √ºber einfache Gleichverteilung hinaus:\n\nüîç **Fairness-Dimensionen:**\n‚Ä¢ **Quantitative Fairness**: Gleiche Anzahl schwerer Schichten\n‚Ä¢ **Qualitative Fairness**: Ber√ºcksichtigung individueller Umst√§nde\n‚Ä¢ **Zeitliche Fairness**: Gleichm√§√üige Verteilung √ºber l√§ngere Zeitr√§ume\n‚Ä¢ **Pr√§ferenz-Fairness**: Ber√ºcksichtigung pers√∂nlicher W√ºnsche\n\nüí° **Best Practices:**\n‚Ä¢ F√ºhren Sie regelm√§√üige Fairness-Audits durch\n‚Ä¢ Lassen Sie Mitarbeiter bewerten und Feedback geben\n‚Ä¢ Dokumentieren Sie alle Verteilungsentscheidungen\n‚Ä¢ Schaffen Sie Ausgleichsmechanismen f√ºr Notf√§lle\n\nIn welchem Bereich sehen Sie aktuell Unfairness?"
    ]
  },
  
  // Optimierung
  optimization: {
    keywords: ['optimieren', 'verbessern', 'effizienz', 'produktivit√§t', 'performance'],
    responses: [
      "Lassen Sie uns Ihren Schichtplan systematisch optimieren:\n\nüéØ **Optimierungs-Framework:**\n\n**1. Datensammlung (IST-Analyse)**\n‚Ä¢ Aktuelle Arbeitszeiten analysieren\n‚Ä¢ √úberstunden-Muster identifizieren\n‚Ä¢ Mitarbeiter-Feedback auswerten\n‚Ä¢ Produktivit√§tskennzahlen messen\n\n**2. Identifikation von Verbesserungspotenzialen**\n‚Ä¢ Engp√§sse in bestimmten Zeitr√§umen\n‚Ä¢ √úberbesetzung zu schwachen Zeiten\n‚Ä¢ Ungleiche Belastungsverteilung\n\n**3. Optimierungsma√ünahmen**\n‚Ä¢ Intelligente Schicht√ºberlappungen\n‚Ä¢ Flexible Arbeitszeiten einf√ºhren\n‚Ä¢ Skillbasierte Zuordnung\n\nWelche KPIs sind f√ºr Sie am wichtigsten?",
      
      "Hier ist mein AI-gest√ºtzter Optimierungsansatz:\n\nü§ñ **Intelligente Optimierung:**\n\n**Algorithmus-Features:**\n‚Ä¢ Predictive Scheduling basierend auf historischen Daten\n‚Ä¢ Automatische Konfliktl√∂sung\n‚Ä¢ Echtzeit-Anpassungen bei √Ñnderungen\n‚Ä¢ Multi-Kriterien-Optimierung (Kosten, Fairness, Effizienz)\n\n**Konkrete Verbesserungen:**\n‚Ä¢ 15-20% Reduktion von √úberstunden\n‚Ä¢ 30% weniger Planungszeit\n‚Ä¢ Verbesserte Work-Life-Balance\n‚Ä¢ H√∂here Mitarbeiterzufriedenheit\n\nSoll ich eine Optimierungsanalyse Ihrer aktuellen Daten durchf√ºhren?"
    ]
  },
  
  // Probleme und Konflikte
  problems: {
    keywords: ['problem', 'konflikt', 'schwierigkeit', 'herausforderung', 'l√∂sung'],
    responses: [
      "Ich helfe Ihnen gerne bei der Probleml√∂sung! Hier sind die h√§ufigsten Schichtplanungs-Probleme und L√∂sungsans√§tze:\n\n‚ö†Ô∏è **Typische Probleme & L√∂sungen:**\n\n**Problem: H√§ufige Krankmeldungen**\n‚Üí L√∂sung: Flexible Vertretungsregelungen, Gesundheitsf√∂rderung\n\n**Problem: Unzufriedenheit mit Schichtverteilung**\n‚Üí L√∂sung: Transparente Kommunikation, Mitbestimmung\n\n**Problem: √úberstunden h√§ufen sich**\n‚Üí L√∂sung: Bessere Bedarfsprognose, Springer-Pool\n\n**Problem: Work-Life-Balance leidet**\n‚Üí L√∂sung: L√§ngere freie Bl√∂cke, Wunschber√ºcksichtigung\n\nBeschreiben Sie mir Ihr spezifisches Problem detaillierter!",
      
      "Probleme in der Schichtplanung erfordern systematische L√∂sungsans√§tze:\n\nüîß **Probleml√∂sungs-Methodik:**\n\n**1. Problemanalyse**\n‚Ä¢ Root-Cause-Analyse durchf√ºhren\n‚Ä¢ Alle Stakeholder befragen\n‚Ä¢ Daten sammeln und auswerten\n\n**2. L√∂sungsentwicklung**\n‚Ä¢ Multiple L√∂sungsoptionen entwickeln\n‚Ä¢ Machbarkeit und Auswirkungen bewerten\n‚Ä¢ Pilotprojekte durchf√ºhren\n\n**3. Implementierung & Monitoring**\n‚Ä¢ Schrittweise Umsetzung\n‚Ä¢ Kontinuierliches Feedback\n‚Ä¢ Anpassungen vornehmen\n\nWas ist Ihr aktuell gr√∂√ütes Problem bei der Schichtplanung?"
    ]
  },
  
  // √úberstunden
  overtime: {
    keywords: ['√ºberstunden', 'mehrarbeit', 'zu viel arbeit', 'arbeitszeit'],
    responses: [
      "√úberstunden-Management ist crucial f√ºr nachhaltiges Personal-Management:\n\n‚è∞ **Anti-√úberstunden-Strategie:**\n\n**Pr√§ventive Ma√ünahmen:**\n‚Ä¢ üìä Bedarfsprognose basierend auf historischen Daten\n‚Ä¢ üë• Aufbau einer flexiblen Springer-Reserve (10-15%)\n‚Ä¢ üîÑ Kreuzqualifizierung der Mitarbeiter\n‚Ä¢ üì± Echtzeit-Monitoring der Arbeitszeiten\n\n**Sofortma√ünahmen bei √úberstunden:**\n‚Ä¢ Umverteilung auf andere Schichten\n‚Ä¢ Externe tempor√§re Unterst√ºtzung\n‚Ä¢ Priorisierung der wichtigsten Aufgaben\n‚Ä¢ Freizeitausgleich statt Bezahlung\n\nüí° **Langfristige L√∂sung:** Implementierung eines predictive Scheduling-Systems, das √úberstunden um bis zu 40% reduzieren kann.\n\nWie hoch ist Ihr aktueller √úberstunden-Anteil?",
      
      "Hier ist mein systematischer Ansatz zur √úberstunden-Reduzierung:\n\nüìà **√úberstunden-Analyse-Framework:**\n\n**Phase 1: Diagnose (Woche 1-2)**\n‚Ä¢ √úberstunden-Hotspots identifizieren\n‚Ä¢ Ursachen kategorisieren (Planung vs. Ungeplant)\n‚Ä¢ Kosten-Nutzen-Analyse durchf√ºhren\n\n**Phase 2: Optimierung (Woche 3-4)**\n‚Ä¢ Schichtl√§ngen anpassen\n‚Ä¢ √úberlappungszeiten optimieren\n‚Ä¢ Skill-Matrix erstellen f√ºr bessere Zuordnung\n\n**Phase 3: Monitoring (Ongoing)**\n‚Ä¢ W√∂chentliche √úberstunden-Reports\n‚Ä¢ Fr√ºhwarnsystem implementieren\n‚Ä¢ Mitarbeiter-Feedback einbeziehen\n\nüéØ **Ziel:** Reduktion der √úberstunden um 35% in 8 Wochen.\n\nSoll ich eine detaillierte Analyse Ihrer √úberstunden-Situation durchf√ºhren?"
    ]
  },
  
  // Urlaub und Abwesenheit
  vacation: {
    keywords: ['urlaub', 'abwesenheit', 'frei', 'fehlzeit', 'krank'],
    responses: [
      "Urlaubs- und Abwesenheitsplanung ist ein komplexes Optimierungsproblem:\n\nüèñÔ∏è **Strategische Urlaubsplanung:**\n\n**Planungsprinzipien:**\n‚Ä¢ üìÖ Fr√ºhe Jahresplanung (Januar) mit Haupturlaubszeiten\n‚Ä¢ üéØ Maximum 30% der Belegschaft gleichzeitig im Urlaub\n‚Ä¢ ‚öñÔ∏è Faire Verteilung von Ferienzeiten und Br√ºckentagen\n‚Ä¢ üîÑ Rotierendes System f√ºr begehrte Termine\n\n**Abwesenheits-Management:**\n‚Ä¢ Krankenstand-Monitoring und Trend-Analyse\n‚Ä¢ Pr√§ventive Gesundheitsma√ünahmen\n‚Ä¢ Schnelle Vertretungsregelungen\n‚Ä¢ Dokumentation aller Fehlzeiten\n\nüí° **Smart-Tip:** Implementieren Sie ein digitales Urlaubsantrag-System mit automatischer Konfliktpr√ºfung.\n\nWie handhaben Sie aktuell Ihre Urlaubsplanung?",
      
      "Hier ist mein AI-Ansatz f√ºr optimales Abwesenheits-Management:\n\nü§ñ **Intelligente Abwesenheits-Vorhersage:**\n\n**Predictive Analytics:**\n‚Ä¢ Krankenstand-Prognosen basierend auf Saison, Wetter, Stress-Level\n‚Ä¢ Urlaubstrends und -pr√§ferenzen analysieren\n‚Ä¢ Automatische Risiko-Bewertung f√ºr kritische Perioden\n\n**Adaptive Planung:**\n‚Ä¢ Dynamische Umplanung bei kurzfristigen Ausf√§llen\n‚Ä¢ Optimierte Vertretungsvorschl√§ge\n‚Ä¢ Skill-basierte Ersatzplanung\n\n**Pr√§ventive Ma√ünahmen:**\n‚Ä¢ Work-Life-Balance Monitoring\n‚Ä¢ Fr√ºhwarnsystem f√ºr Burnout-Risiko\n‚Ä¢ Gesundheitsf√∂rderung basierend auf Abwesenheits-Mustern\n\nüìä **Ergebnis:** Bis zu 25% weniger ungeplante Abwesenheiten durch proaktives Management.\n\nM√∂chten Sie, dass ich Ihre Abwesenheitsmuster analysiere?"
    ]
  },
  
  // Mitarbeiter-Pr√§ferenzen
  preferences: {
    keywords: ['wunsch', 'pr√§ferenz', 'bevorzugung', 'mitarbeiter wollen', 'individuelle'],
    responses: [
      "Mitarbeiter-Pr√§ferenzen intelligent zu ber√ºcksichtigen ist der Schl√ºssel zur Zufriedenheit:\n\nüë• **Pr√§ferenz-Management-System:**\n\n**Erfassung von Pr√§ferenzen:**\n‚Ä¢ üìã Detaillierte Wunsch-Profile erstellen\n‚Ä¢ üéØ Gewichtung nach Wichtigkeit (1-10 Skala)\n‚Ä¢ üìÖ Zeitr√§ume definieren (dauerhaft vs. tempor√§r)\n‚Ä¢ üí° Begr√ºndungen verstehen und dokumentieren\n\n**Intelligente Ber√ºcksichtigung:**\n‚Ä¢ 70% Wunsch-Erf√ºllung als Ziel\n‚Ä¢ Fairness-Index f√ºr Wunsch-Verteilung\n‚Ä¢ Kompromiss-Vorschl√§ge bei Konflikten\n‚Ä¢ Langfristige Ausgleichsmechanismen\n\n**Kommunikation:**\n‚Ä¢ Transparente Erkl√§rung bei Nicht-Erf√ºllung\n‚Ä¢ Alternative L√∂sungsvorschl√§ge anbieten\n‚Ä¢ Regelm√§√üige Pr√§ferenz-Updates erm√∂glichen\n\nWie erfassen Sie aktuell die W√ºnsche Ihrer Mitarbeiter?",
      
      "Hier ist mein wissenschaftlicher Ansatz f√ºr Pr√§ferenz-Optimierung:\n\nüß† **Psychologische Aspekte:**\n\n**Motivations-Theorie:**\n‚Ä¢ Autonomie: Mitspracherecht bei der Schichtplanung\n‚Ä¢ Competence: Passende Aufgaben zu den F√§higkeiten\n‚Ä¢ Relatedness: Ber√ºcksichtigung von Teamw√ºnschen\n\n**Pr√§ferenz-Kategorien:**\n‚Ä¢ üïê Zeitliche Pr√§ferenzen (Fr√ºh vs. Sp√§t)\n‚Ä¢ üë´ Soziale Pr√§ferenzen (Team-Zusammenstellung)\n‚Ä¢ üìç Arbeitsplatz-Pr√§ferenzen (Standort, Bereich)\n‚Ä¢ üîÑ Rotations-Pr√§ferenzen (Abwechslung vs. Routine)\n\n**Optimierungs-Algorithmus:**\n‚Ä¢ Multi-objektive Optimierung\n‚Ä¢ Pareto-Effizienz zwischen individuellen und betrieblichen Zielen\n‚Ä¢ Maschinelles Lernen zur Pr√§ferenz-Vorhersage\n\nüéØ **Ziel:** 85%+ Zufriedenheit bei gleichzeitiger Betriebseffizienz.\n\nSoll ich ein Pr√§ferenz-Analyse-System f√ºr Sie entwickeln?"
    ]
  }
};

// Allgemeine Antworten f√ºr unbekannte Fragen
const generalResponses = [
  "Das ist eine interessante Frage zur Schichtplanung! K√∂nnen Sie mir mehr Details geben? Je spezifischer Sie sind, desto besser kann ich Ihnen helfen.\n\nü§î **Hilfreiche Informationen w√§ren:**\n‚Ä¢ Wie viele Mitarbeiter haben Sie?\n‚Ä¢ Welche Schichtarten verwenden Sie?\n‚Ä¢ Was ist Ihr konkretes Ziel?\n‚Ä¢ Welche Herausforderungen haben Sie aktuell?\n\nMit diesen Informationen kann ich Ihnen eine ma√ügeschneiderte L√∂sung vorschlagen!",
  
  "Als KI-Experte f√ºr Schichtplanung bin ich spezialisiert auf die Optimierung von Arbeitsabl√§ufen. Ihre Frage ber√ºhrt ein wichtiges Thema!\n\nüí° **Meine Expertise umfasst:**\n‚Ä¢ Algorithmusbasierte Schichtoptimierung\n‚Ä¢ Fairness-Analysen und -Verbesserungen\n‚Ä¢ Produktivit√§tssteigerung durch intelligente Planung\n‚Ä¢ Mitarbeiterzufriedenheit maximieren\n‚Ä¢ Kostenoptimierung bei Personalplanung\n\nK√∂nnen Sie Ihre Frage pr√§zisieren, damit ich Ihnen eine detaillierte, datenbasierte Antwort geben kann?",
  
  "Excellent! Sie sprechen einen wichtigen Aspekt der modernen Personalplanung an. Lassen Sie uns das systematisch angehen:\n\nüéØ **Mein Ansatz:**\n1. **Situationsanalyse:** Was ist Ihr aktueller Stand?\n2. **Zieldefinition:** Was m√∂chten Sie erreichen?\n3. **L√∂sungsentwicklung:** Ma√ügeschneiderte Strategien\n4. **Umsetzungsplan:** Schritt-f√ºr-Schritt Anleitung\n5. **Monitoring:** Erfolgsmessung und Anpassung\n\nTeilen Sie mir mehr Details mit, damit ich Ihnen eine spezifische, umsetzbare L√∂sung vorschlagen kann!"
];

// Intelligente Antwort-Generierung
function generateAIResponse(message) {
  const lowerMessage = message.toLowerCase();
  
  // Durchsuche Wissensdatenbank nach passenden Keywords
  for (const [category, data] of Object.entries(aiKnowledge)) {
    for (const keyword of data.keywords) {
      if (lowerMessage.includes(keyword)) {
        // Zuf√§llige Antwort aus der Kategorie w√§hlen
        const response = data.responses[Math.floor(Math.random() * data.responses.length)];
        addTopic(category);
        return response;
      }
    }
  }
  
  // Spezielle Muster erkennen
  if (lowerMessage.includes('team a') || lowerMessage.includes('team b') || lowerMessage.includes('team c') || lowerMessage.includes('team d')) {
    addTopic('Team-Management');
    return generateTeamSpecificResponse(message);
  }
  
  if (lowerMessage.includes('ki') || lowerMessage.includes('k√ºnstliche intelligenz') || lowerMessage.includes('algorithmus')) {
    addTopic('KI-Features');
    return generateAIFeatureResponse(message);
  }
  
  if (lowerMessage.includes('kosten') || lowerMessage.includes('budget') || lowerMessage.includes('sparen')) {
    addTopic('Kostenoptimierung');
    return generateCostResponse(message);
  }
  
  // Fallback: Allgemeine Antwort
  addTopic('Allgemeine Beratung');
  return generalResponses[Math.floor(Math.random() * generalResponses.length)];
}

// Spezielle Antwort-Generatoren
function generateTeamSpecificResponse(message) {
  return `Ich sehe, Sie sprechen √ºber spezifische Teams! Hier ist meine Analyse:\n\nüë• **Team-spezifische Optimierung:**\n\n**Aktuelle Team-Konfiguration:**\n‚Ä¢ Team A: Starkes Fr√ºhschicht-Team (empfohlen: 6:00-14:00)\n‚Ä¢ Team B: Flexibles Vollzeit-Team (empfohlen: 8:00-16:00)\n‚Ä¢ Team C: Sp√§tschicht-Spezialist (empfohlen: 14:00-22:00)\n‚Ä¢ Team D: Nachtschicht-Rotation (empfohlen: 22:00-6:00)\n\nüéØ **Optimierungsvorschl√§ge:**\n‚Ä¢ Cross-Training zwischen Teams f√ºr mehr Flexibilit√§t\n‚Ä¢ Regelm√§√üige Team-Rotation (alle 3 Monate)\n‚Ä¢ Skill-Matrix basierte Zuordnungen\n‚Ä¢ Team-Performance-Monitoring\n\nüìä **Erwartete Verbesserungen:**\n‚Ä¢ +15% Produktivit√§t durch optimale Team-Zeit-Zuordnung\n‚Ä¢ +25% Mitarbeiterzufriedenheit\n‚Ä¢ -20% ungeplante √úberstunden\n\nSoll ich eine detaillierte Team-Analyse f√ºr Sie durchf√ºhren?`;
}

function generateAIFeatureResponse(message) {
  return `Exzellent! Sie interessieren sich f√ºr die KI-Features. Hier sind meine erweiterten F√§higkeiten:\n\nü§ñ **Advanced AI Capabilities:**\n\n**Machine Learning Features:**\n‚Ä¢ üìà Predictive Analytics f√ºr Personalbedarfsprognosen\n‚Ä¢ üîç Pattern Recognition in Arbeitszeit-Daten\n‚Ä¢ üéØ Personalized Recommendations f√ºr jeden Mitarbeiter\n‚Ä¢ ‚ö° Real-time Optimization bei Planungs√§nderungen\n\n**Algorithmus-Portfolio:**\n‚Ä¢ Genetic Algorithm f√ºr optimale Schichtverteilung\n‚Ä¢ Neural Networks f√ºr Krankenstand-Vorhersage\n‚Ä¢ Constraint Satisfaction f√ºr Regel-Compliance\n‚Ä¢ Multi-objective Optimization f√ºr Zielkonflikte\n\n**Intelligente Features:**\n‚Ä¢ Automatische Konfliktl√∂sung\n‚Ä¢ Fairness-Scoring mit Bias-Erkennung\n‚Ä¢ Sentiment-Analyse aus Mitarbeiter-Feedback\n‚Ä¢ Predictive Burnout-Prevention\n\nüöÄ **Next-Gen Features in Entwicklung:**\n‚Ä¢ Integration mit IoT-Sensoren f√ºr Arbeitsplatz-Optimierung\n‚Ä¢ Voice-Interface f√ºr nat√ºrliche Planungsanfragen\n‚Ä¢ AR/VR Visualisierung komplexer Schichtpl√§ne\n\nWelche KI-Features interessieren Sie am meisten?`;
}

function generateCostResponse(message) {
  return `Kostenoptimierung ist ein Schl√ºsselaspekt erfolgreicher Schichtplanung! Hier meine Analyse:\n\nüí∞ **ROI-orientierte Schichtplanung:**\n\n**Kostenfaktoren identifizieren:**\n‚Ä¢ üìä √úberstunden-Kosten (oft 25-50% h√∂her als Normalstunden)\n‚Ä¢ üè• Krankheitsbedingte Ausfallkosten\n‚Ä¢ üîÑ Rekrutierung und Einarbeitung\n‚Ä¢ ‚ö° Produktivit√§tsverluste durch suboptimale Planung\n\n**Einsparungspotentiale:**\n‚Ä¢ ‚úÇÔ∏è 30% √úberstunden-Reduktion = ‚Ç¨12.000/Jahr (bei 10 Mitarbeitern)\n‚Ä¢ üìà 20% Produktivit√§tssteigerung durch optimale Zuordnung\n‚Ä¢ üè• 15% weniger krankheitsbedingte Ausf√§lle\n‚Ä¢ ‚è±Ô∏è 60% weniger Planungszeit f√ºr Manager\n\n**ROI-Berechnung f√ºr KI-Schichtplanung:**\n‚Ä¢ Investition: ~‚Ç¨2.000 Setup + ‚Ç¨200/Monat\n‚Ä¢ Einsparungen: ~‚Ç¨15.000-25.000/Jahr\n‚Ä¢ **Break-Even: 3-4 Monate**\n‚Ä¢ **ROI nach 12 Monaten: 400-800%**\n\nüìä Soll ich eine detaillierte Kosten-Nutzen-Analyse f√ºr Ihr Unternehmen erstellen?`;
}

// Chat-Funktionalit√§t
function addMessage(content, isUser = false, timestamp = new Date()) {
  const messagesContainer = document.getElementById('chatMessages');
  const messageDiv = document.createElement('div');
  messageDiv.className = `message ${isUser ? 'user' : 'ai'}`;
  
  const timeString = timestamp.toLocaleTimeString('de-DE', { 
    hour: '2-digit', 
    minute: '2-digit' 
  });
  
  messageDiv.innerHTML = `
    <div class="message-avatar">${isUser ? 'üë§' : 'ü§ñ'}</div>
    <div class="message-content">
      ${content.replace(/\n/g, '<br>')}
      <div class="message-time">${timeString}</div>
    </div>
  `;
  
  // Typing indicator entfernen
  const typingIndicator = document.getElementById('typingIndicator');
  typingIndicator.style.display = 'none';
  
  messagesContainer.appendChild(messageDiv);
  messagesContainer.scrollTop = messagesContainer.scrollHeight;
  
  // Konversation speichern
  conversationHistory.push({
    content,
    isUser,
    timestamp
  });
  
  // Message count aktualisieren
  messageCount++;
  document.getElementById('messageCount').textContent = messageCount;
}

function showTypingIndicator() {
  const typingIndicator = document.getElementById('typingIndicator');
  typingIndicator.style.display = 'flex';
  
  const messagesContainer = document.getElementById('chatMessages');
  messagesContainer.scrollTop = messagesContainer.scrollHeight;
}

function addTopic(topic) {
  topicsDiscussed.add(topic);
  updateTopicsDisplay();
}

function updateTopicsDisplay() {
  const topicsElement = document.getElementById('topicsDiscussed');
  topicsElement.innerHTML = Array.from(topicsDiscussed)
    .map(topic => `‚Ä¢ ${topic}`)
    .join('<br>');
}

// Nachricht senden
async function sendMessage() {
  const input = document.getElementById('chatInput');
  const message = input.value.trim();
  
  if (!message) return;
  
  // User message hinzuf√ºgen
  addMessage(message, true);
  input.value = '';
  
  // Typing indicator zeigen
  showTypingIndicator();
  
  // Realistische Verz√∂gerung f√ºr KI-Verarbeitung
  const delay = Math.max(1000, Math.min(4000, message.length * 50));
  
  setTimeout(() => {
    const response = generateAIResponse(message);
    addMessage(response, false);
  }, delay);
  
  // Input zur√ºcksetzen
  adjustTextareaHeight();
}

// Schnelle Fragen
function askQuickQuestion(question) {
  document.getElementById('chatInput').value = question;
  sendMessage();
}

// Textarea Auto-Resize
function adjustTextareaHeight() {
  const textarea = document.getElementById('chatInput');
  textarea.style.height = 'auto';
  textarea.style.height = Math.min(textarea.scrollHeight, 120) + 'px';
}

// Gespr√§ch exportieren
function exportConversation() {
  const conversationText = conversationHistory
    .map(msg => `${msg.isUser ? 'Sie' : 'KI-Assistent'} (${msg.timestamp.toLocaleString('de-DE')}):\n${msg.content}\n`)
    .join('\n---\n\n');
  
  const blob = new Blob([conversationText], { type: 'text/plain;charset=utf-8' });
  const url = window.URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = `ki-gespraech-${new Date().toISOString().split('T')[0]}.txt`;
  a.click();
  window.URL.revokeObjectURL(url);
  
  showNotification('üì• Gespr√§ch exportiert!');
}

// Hilfsfunktionen
function showNotification(message) {
  const notification = document.createElement('div');
  notification.style.cssText = `
    position: fixed;
    top: 20px;
    right: 20px;
    background: var(--ai-gradient);
    color: white;
    padding: 1rem 1.5rem;
    border-radius: 1rem;
    font-weight: 600;
    z-index: 1001;
    animation: slideInRight 0.5s ease;
    box-shadow: var(--shadow);
    max-width: 300px;
  `;
  notification.textContent = message;
  document.body.appendChild(notification);
  
  setTimeout(() => {
    notification.style.animation = 'slideOutRight 0.3s ease';
    setTimeout(() => notification.remove(), 300);
  }, 3000);
}

// Event Listeners
document.addEventListener('DOMContentLoaded', function() {
  const chatInput = document.getElementById('chatInput');
  const sendBtn = document.getElementById('sendBtn');
  
  // Auto-resize f√ºr Textarea
  chatInput.addEventListener('input', adjustTextareaHeight);
  
  // Enter zum Senden
  chatInput.addEventListener('keydown', function(e) {
    if (e.key === 'Enter' && !e.shiftKey) {
      e.preventDefault();
      sendMessage();
    }
  });
  
  // Send Button
  sendBtn.addEventListener('click', sendMessage);
  
  // Initial height
  adjustTextareaHeight();
});

// Animationen
const style = document.createElement('style');
style.textContent = `
  @keyframes slideInRight {
    from { opacity: 0; transform: translateX(100px); }
    to { opacity: 1; transform: translateX(0); }
  }
  
  @keyframes slideOutRight {
    from { opacity: 1; transform: translateX(0); }
    to { opacity: 0; transform: translateX(100px); }
  }
`;
document.head.appendChild(style);
</script>

</body>
</html>